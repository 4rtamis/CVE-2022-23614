FROM debian:bullseye

COPY snapshot.list /etc/apt/sources.list.d/snapshot.list

RUN apt-get -o Acquire::Check-Valid-Until=false -o Acquire::AllowInsecureRepositories=true -o Acquire::AllowDowngradeToInsecureRepositories=true update
RUN apt-get install -y --allow-unauthenticated --allow-downgrades --fix-missing aptitude nano adduser

RUN DEBIAN_FRONTEND=non-interactive aptitude -y --allow-untrusted -o Aptitude::ProblemResolver::SolutionCost='100*canceled-actions,200*removals' install php-twig=2.14.3-1

RUN apt-get install -y php7.4 php-twig

COPY exploit/index.php /exploit/index.php

WORKDIR /exploit

# Example of the exploit
CMD ["php", "index.php", "system", "{\"args\": [\"id\", \"\"]}"]